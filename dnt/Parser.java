/** * DNT file parser; creates a CSV file given a DNT file. */import java.io.*;class Parser {  private File file;  public Parser(File file) {    this.file = file;  }  public DNT parse()    throws IOException  {    RandomAccessFileLE ptr = new RandomAccessFileLE(file, "r");    ptr.seek(4);    short cols = ptr.readShortLE();    int rows = ptr.readIntLE();    /*System.out.println("Cols = " + cols);    System.out.println("Rows = " + rows);*/    DNT dnt = new DNT(rows, cols);    for(int i = 0; i < cols; i++) {      String name = ptr.readString(ptr.readShortLE());      dnt.addHeader(name, Type.getType(ptr.readByte()));    }    for(int i = 0; i < rows; i++) {      for(DNT.Header h : dnt.getHeader()) {        switch(h.getType()) {          case STRING: dnt.add(ptr.readString(ptr.readShortLE())); break;          case BOOL:   dnt.add(ptr.readIntLE() != 0); break;          case INT:    dnt.add(ptr.readIntLE()); break;          case FLOAT:  dnt.add(ptr.readFloatLE()); break;          case DOUBLE: dnt.add(ptr.readFloatLE()); break;          case NULL:   throw new RuntimeException("UNKNOWN DATA TYPE READ");        }      }    }    ptr.close();    return dnt;  }  public static void main(String args[])    throws IOException  {    if(args.length != 2) {      System.out.println("Usage: java Parser DNTFile outputCSV");      System.exit(1);    }    File dntFile = new File(args[0]).getCanonicalFile();    File csvFile = new File(args[1]).getCanonicalFile();    if(! csvFile.getParentFile().exists() && ! csvFile.mkdirs()) {      System.out.println("Cannot create output CSV file.");      System.exit(1);    }    FileWriter out = new FileWriter(csvFile);    Parser p = new Parser(dntFile);    DNT dnt = p.parse();    String prepend = "";    for(DNT.Header h : dnt.getHeader()) {      out.append(prepend);      out.append(h.getName());      prepend = ",";    }    out.append("\n");    for(int i = 0; i < dnt.getRows(); i++) {      prepend = "";      String[] entry = dnt.getRow(i);      for(DNT.Header h : dnt.getHeader()) {        out.append(prepend);        if(h.getType() == Type.STRING) {          out.append("\"");        }        out.append(entry[h.getIndex()]);        if(h.getType() == Type.STRING) {          out.append("\"");        }        prepend = ",";      }      out.append("\n");    }    out.close();    System.out.println("Total Columns: " + dnt.getCols());    System.out.println("Entries: " + dnt.getRows());  }}